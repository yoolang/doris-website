"use strict";(self.webpackChunkdoris_website=self.webpackChunkdoris_website||[]).push([[142603],{15680:(e,t,n)=>{n.d(t,{xA:()=>c,yg:()=>m});var a=n(296540);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=a.createContext({}),p=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},c=function(e){var t=p(e.components);return a.createElement(s.Provider,{value:t},e.children)},d="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},g=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,s=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),d=p(n),g=r,m=d["".concat(s,".").concat(g)]||d[g]||u[g]||o;return n?a.createElement(m,i(i({ref:t},c),{},{components:n})):a.createElement(m,i({ref:t},c))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,i=new Array(o);i[0]=g;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[d]="string"==typeof e?e:r,i[1]=l;for(var p=2;p<o;p++)i[p]=n[p];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}g.displayName="MDXCreateElement"},253486:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>i,default:()=>u,frontMatter:()=>o,metadata:()=>l,toc:()=>p});var a=n(58168),r=(n(296540),n(15680));const o={title:"Config and install FDB",language:"en"},i=void 0,l={unversionedId:"install/cluster-deployment/k8s-deploy/compute-storage-decoupled/install-metaservice/config-fdb",id:"install/cluster-deployment/k8s-deploy/compute-storage-decoupled/install-metaservice/config-fdb",title:"Config and install FDB",description:"\x3c!--",source:"@site/docs/install/cluster-deployment/k8s-deploy/compute-storage-decoupled/install-metaservice/config-fdb.md",sourceDirName:"install/cluster-deployment/k8s-deploy/compute-storage-decoupled/install-metaservice",slug:"/install/cluster-deployment/k8s-deploy/compute-storage-decoupled/install-metaservice/config-fdb",permalink:"/docs/dev/install/cluster-deployment/k8s-deploy/compute-storage-decoupled/install-metaservice/config-fdb",draft:!1,tags:[],version:"current",frontMatter:{title:"Config and install FDB",language:"en"},sidebar:"docs",previous:{title:"Compute-storage decoupled quick start",permalink:"/docs/dev/install/cluster-deployment/k8s-deploy/compute-storage-decoupled/install-quickstart"},next:{title:"Config and install MS",permalink:"/docs/dev/install/cluster-deployment/k8s-deploy/compute-storage-decoupled/install-metaservice/config-ms"}},s={},p=[{value:"Simplest configuration",id:"simplest-configuration",level:2},{value:"Specify image deployment",id:"specify-image-deployment",level:2},{value:"Private warehouse public image configuration",id:"private-warehouse-public-image-configuration",level:3},{value:"Configure storage",id:"configure-storage",level:2}],c={toc:p},d="wrapper";function u(e){let{components:t,...n}=e;return(0,r.yg)(d,(0,a.A)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,r.yg)("p",null,"Doris Compute-storage decoupled uses FoundationDB as the metadata storage component. In K8s deployment mode, use the ",(0,r.yg)("inlineCode",{parentName:"p"},"v1beta2")," version of ",(0,r.yg)("a",{parentName:"p",href:"https://github.com/FoundationDB/fdb-kubernetes-operator"},"fdb-kubernetes-operator")," to deploy ",(0,r.yg)("inlineCode",{parentName:"p"},"fdb"),"."),(0,r.yg)("p",null,"Doris-Operator shields the tediousness of manually configuring ",(0,r.yg)("inlineCode",{parentName:"p"},"FoundationDBCluster"),", and abstracts very little configuration information to reduce the cost of learning to use ",(0,r.yg)("inlineCode",{parentName:"p"},"FoundationDBCluster")," resources. Through abstraction, Doris-Operator hopes that users only focus on matters related to FDB deployment, without paying attention to the internal operating mechanism of FDB and the complex connection between Doris and FDB."),(0,r.yg)("h2",{id:"simplest-configuration"},"Simplest configuration"),(0,r.yg)("p",null,"By default, you only need to configure the resources used by FDB, and Doris-Operator automatically generates ",(0,r.yg)("inlineCode",{parentName:"p"},"FoundationDBCluster")," to deploy the FDB metadata management cluster."),(0,r.yg)("p",null,"Default configuration:"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-yaml"},"spec:\n  fdb:\n    requests:\n      cpu: 4\n      memory: 4Gi\n    limits:\n      cpu: 4\n      memory: 4Gi\n")),(0,r.yg)("p",null,"With the above configuration, Doris-Operator will automatically deploy an FDB cluster consisting of 5 pods."),(0,r.yg)("h2",{id:"specify-image-deployment"},"Specify image deployment"),(0,r.yg)("p",null,"Doris-Operator uses the 7.1.38 version recommended by Doris to deploy FDB by default. In a privatized environment and if there are special requirements for the FDB version, please configure the image or configure the private warehouse image pull key in the following format."),(0,r.yg)("h3",{id:"private-warehouse-public-image-configuration"},"Private warehouse public image configuration"),(0,r.yg)("p",null,"In the case of a private warehouse or external network access failure, you need to configure the private image warehouse address."),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-yaml"},"spec:\n  fdb:\n    image: {fdb_image}\n    sidecarImage: {fdb_sidecarImage}\n")),(0,r.yg)("p",null,"Set ",(0,r.yg)("inlineCode",{parentName:"p"},"{fdb_image}")," to the corresponding FoundationDB main image (",(0,r.yg)("inlineCode",{parentName:"p"},"selectdb/foundationdb:xxx")," in the selectdb repository), and ",(0,r.yg)("inlineCode",{parentName:"p"},"{fdb_sidecarImage}")," to the FDB sidecar container image (",(0,r.yg)("inlineCode",{parentName:"p"},"selectdb/foundationdb-kubernetes-sidecar:xxx")," in the selectdb repository)."),(0,r.yg)("p",null,"Configure the specified image-related configuration to the ","[",(0,r.yg)("inlineCode",{parentName:"p"},"DorisDisaggregatedMetaService"),"]","(../install-quickstart#Install DorisDisaggregatedMetaService) resource that needs to be deployed."),(0,r.yg)("p",null,(0,r.yg)("strong",{parentName:"p"},"Configure image secret")),(0,r.yg)("p",null,"When using a private repository, if you configure access keys, follow the ",(0,r.yg)("a",{parentName:"p",href:"https://kubernetes.io/docs/tasks/configure-pod-container/pull-image-private-registry/"},"Kubernetes private repository imagePullSecret")," creation steps to create the corresponding secret and deploy it to the ",(0,r.yg)("inlineCode",{parentName:"p"},"DorisDisaggregatedMetaService")," namespace."),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-yaml"},"spec:\n  fdb:\n    image: {fdb_image}\n    sidecarImage: {fdb_sidecarImage}\n    imagePullSecrets:\n    - {secret_name}\n    requests:\n      cpu: 4\n      memory: 4Gi\n    limits:\n      cpu: 4\n      memory: 4Gi\n")),(0,r.yg)("p",null,"For the configuration of ",(0,r.yg)("inlineCode",{parentName:"p"},"{fdb_image}")," and ",(0,r.yg)("inlineCode",{parentName:"p"},"{fdb_sidecarImage}"),", please refer to the private repository public image configuration ** ** related introduction. ",(0,r.yg)("inlineCode",{parentName:"p"},"{secret_name}")," is the name of the secret created according to the Kubernetes private repository ",(0,r.yg)("inlineCode",{parentName:"p"},"imagePullSecret"),"."),(0,r.yg)("p",null,"Add the above configuration to the ","[",(0,r.yg)("inlineCode",{parentName:"p"},"DorisDisaggregatedMetaSerivce"),"]","(/docs/dev/install/cluster-deployment/k8s-deploy/compute-storage-decoupled/install-quickstart#Install DorisDisaggregatedMetaService) resource that needs to be deployed."),(0,r.yg)("h2",{id:"configure-storage"},"Configure storage"),(0,r.yg)("p",null,"FoundationDB is a stateful distributed storage service that needs to configure persistent storage. By default, Doris-Operator will use the default StorageClass in Kubernetes to build the relevant pvc for the FDB pod. The default size of pvc is 128Gi. If you need to specify StorageClass and modify the default configuration size, please modify it as follows:"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-yaml"},'spec:\n  fdb:\n    volumeClaimTemplate:\n      spec:\n        #storageClassName: {storageClassName}\n        resources:\n          requests:\n            storage: "200Gi"\n')),(0,r.yg)("p",null,"The above configuration uses the default StorageClass to create a 200Gi storage for the FDB service. If you need to specify a StorageClass, uncomment it and replace the variable ",(0,r.yg)("inlineCode",{parentName:"p"},"{storageClassName}")," with the name of the StorageClass you want to specify."),(0,r.yg)("p",null,"Add the above configuration to the ","[",(0,r.yg)("inlineCode",{parentName:"p"},"DorisDisaggregatedMetaSerivce"),"]","(/docs/dev/install/cluster-deployment/k8s-deploy/compute-storage-decoupled/install-quickstart#Install DorisDisaggregatedMetaService) resource that needs to be deployed."))}u.isMDXComponent=!0}}]);