"use strict";(self.webpackChunkdoris_website=self.webpackChunkdoris_website||[]).push([[829050],{15680:(e,t,o)=>{o.d(t,{xA:()=>d,yg:()=>m});var n=o(296540);function a(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function r(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function i(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?r(Object(o),!0).forEach((function(t){a(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):r(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function l(e,t){if(null==e)return{};var o,n,a=function(e,t){if(null==e)return{};var o,n,a={},r=Object.keys(e);for(n=0;n<r.length;n++)o=r[n],t.indexOf(o)>=0||(a[o]=e[o]);return a}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)o=r[n],t.indexOf(o)>=0||Object.prototype.propertyIsEnumerable.call(e,o)&&(a[o]=e[o])}return a}var s=n.createContext({}),c=function(e){var t=n.useContext(s),o=t;return e&&(o="function"==typeof e?e(t):i(i({},t),e)),o},d=function(e){var t=c(e.components);return n.createElement(s.Provider,{value:t},e.children)},u="mdxType",p={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},g=n.forwardRef((function(e,t){var o=e.components,a=e.mdxType,r=e.originalType,s=e.parentName,d=l(e,["components","mdxType","originalType","parentName"]),u=c(o),g=a,m=u["".concat(s,".").concat(g)]||u[g]||p[g]||r;return o?n.createElement(m,i(i({ref:t},d),{},{components:o})):n.createElement(m,i({ref:t},d))}));function m(e,t){var o=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=o.length,i=new Array(r);i[0]=g;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[u]="string"==typeof e?e:a,i[1]=l;for(var c=2;c<r;c++)i[c]=o[c];return n.createElement.apply(null,i)}return n.createElement.apply(null,o)}g.displayName="MDXCreateElement"},887318:(e,t,o)=>{o.r(t),o.d(t,{assets:()=>s,contentTitle:()=>i,default:()=>p,frontMatter:()=>r,metadata:()=>l,toc:()=>c});var n=o(58168),a=(o(296540),o(15680));const r={title:"Cluster dependency association configuration",language:"en"},i=void 0,l={unversionedId:"install/cluster-deployment/k8s-deploy/compute-storage-decoupled/install-cluster/config-relation",id:"install/cluster-deployment/k8s-deploy/compute-storage-decoupled/install-cluster/config-relation",title:"Cluster dependency association configuration",description:"\x3c!--",source:"@site/docs/install/cluster-deployment/k8s-deploy/compute-storage-decoupled/install-cluster/config-relation.md",sourceDirName:"install/cluster-deployment/k8s-deploy/compute-storage-decoupled/install-cluster",slug:"/install/cluster-deployment/k8s-deploy/compute-storage-decoupled/install-cluster/config-relation",permalink:"/docs/dev/install/cluster-deployment/k8s-deploy/compute-storage-decoupled/install-cluster/config-relation",draft:!1,tags:[],version:"current",frontMatter:{title:"Cluster dependency association configuration",language:"en"},sidebar:"docs",previous:{title:"Config and install Recycler",permalink:"/docs/dev/install/cluster-deployment/k8s-deploy/compute-storage-decoupled/install-metaservice/config-recycler"},next:{title:"Config and install FE",permalink:"/docs/dev/install/cluster-deployment/k8s-deploy/compute-storage-decoupled/install-cluster/config-fe"}},s={},c=[{value:"Register object storage",id:"register-object-storage",level:2},{value:"Configure metadata resource information",id:"configure-metadata-resource-information",level:2}],d={toc:c},u="wrapper";function p(e){let{components:t,...o}=e;return(0,a.yg)(u,(0,n.A)({},d,o,{components:t,mdxType:"MDXLayout"}),(0,a.yg)("h2",{id:"register-object-storage"},"Register object storage"),(0,a.yg)("p",null,"To deploy a Compute-storage decoupled cluster, you need to plan the object storage to be used in advance, and configure the object storage information through ConfigMap to the Namespace where the Doris Compute-storage decoupled cluster needs to be deployed."),(0,a.yg)("p",null,"The following shows the ConfigMap format composed of the required configuration information of the object storage of the Compute-storage decoupled cluster using the S3 protocol:"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-yaml"},'apiVersion: v1\ndata:\n  instance.conf: |\n    {\n      "instance_id": "disaggregated-test-cluster3",\n      "name": "instance-name",\n      "user_id": "test_user",\n      "vault": {\n        "obj_info": {\n          "ak": "test_ak",\n          "sk": "test_sk",\n          "bucket": "test_bucket",\n          "prefix": "test-prefix",\n          "endpoint": "cos.ap-beijing.myqcloud.com",\n          "external_endpoint": "cos.ap-beijing.myqcloud.com",\n          "region": "ap-beijing",\n          "provider": "COS"\n        }\n      }\n    }\nkind: ConfigMap\nmetadata:\n  name: vault-test\n  namespace: default\n')),(0,a.yg)("p",null,"Object storage information is configured in JSON format. When using ConfigMap as the configuration carrier, ",(0,a.yg)("inlineCode",{parentName:"p"},"instance.conf")," must be used as the key and the object storage information in JSON format as a whole as the value. For detailed configuration of object storage, please refer to the ","[Compute-storage decoupled document]","(/docs/dev/install/cluster-deployment/k8s-deploy/compute-storage-decoupled/install-quickstart#Install DorisDisaggregatedCluster)."),(0,a.yg)("p",null,(0,a.yg)("inlineCode",{parentName:"p"},"DorisDisaggregatedCluster")," uses the above configuration as the backend object storage configuration as follows:"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-yaml"},"apiVersion: disaggregated.cluster.doris.com/v1\nkind: DorisDisaggregatedCluster\nmetadata:\n  name: test-disaggregated-cluster\n  namespace: default\nspec:\n  instanceConfigMap: vault-test\n")),(0,a.yg)("p",null,"During deployment, update the configuration as described above and update it to the ","[Compute-storage decoupled resources to be deployed]","(/docs/dev/install/cluster-deployment/k8s-deploy/compute-storage-decoupled/install-quickstart#Install DorisDisaggregatedCluster)."),(0,a.yg)("admonition",{title:"Tip",type:"tip"},(0,a.yg)("ol",{parentName:"admonition"},(0,a.yg)("li",{parentName:"ol"},"The configuration information in the above ConfigMap is to show the required key-value pairs. All value values are fictitious and cannot be used in the real environment. Please fill in the actual information of the object storage that actually supports the S3 protocol according to the Compute-storage decoupled document."),(0,a.yg)("li",{parentName:"ol"},"ConfigMap must be deployed in advance to the namespace where the Compute-storage decoupled cluster is expected to be deployed."))),(0,a.yg)("h2",{id:"configure-metadata-resource-information"},"Configure metadata resource information"),(0,a.yg)("p",null,"To deploy a Compute-storage decoupled cluster, you need to specify the metadata resource information to be used. Before deploying ",(0,a.yg)("inlineCode",{parentName:"p"},"DorisDisaggregatedCluster"),", you need to plan and deploy the ",(0,a.yg)("inlineCode",{parentName:"p"},"DorisDisaggregatedMetaService")," resource to be used. Fill in the following configuration as needed and update it to the ","[Compute-storage decoupled resource to be deployed]","(/docs/dev/install/cluster-deployment/k8s-deploy/compute-storage-decoupled/install-quickstart#Install DorisDisaggregatedCluster)."),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-yaml"},"spec:\n  disMS:\n    namespace: {metaServiceNamespace}\n    name: {metaServiceName}\n")),(0,a.yg)("p",null,"Fill in the above information according to the actual resources used. ",(0,a.yg)("inlineCode",{parentName:"p"},"{metaServiceNamespace}")," is the namespace where the ",(0,a.yg)("inlineCode",{parentName:"p"},"DorisDisaggregatedMetaService")," resource is deployed, and ",(0,a.yg)("inlineCode",{parentName:"p"},"{metaServiceName}")," is the name of the ",(0,a.yg)("inlineCode",{parentName:"p"},"DorisDisaggregatedMetaService")," resource used."),(0,a.yg)("p",null,"Update the filled information to the ","[Compute-storage decoupled resources to be deployed]","(/docs/dev/install/cluster-deployment/k8s-deploy/compute-storage-decoupled/install-quickstart#Install DorisDisaggregatedCluster)."))}p.isMDXComponent=!0}}]);